# HTTP Parse Library Examples Makefile
# ç¼–è¯‘HTTP/1.xå’ŒHTTP/2åè®®ç¤ºä¾‹ç¨‹åº

CXX = g++
CXXFLAGS = -std=c++23 -Wall -Wextra -O2 -g
INCLUDES = -I../include
LDFLAGS = -pthread

# ç›®æ ‡æ–‡ä»¶
TARGETS = http1_example http2_example comprehensive_example

# é»˜è®¤ç›®æ ‡
all: $(TARGETS)

# ç¼–è¯‘HTTP/1.xç¤ºä¾‹
http1_example: http1_example.cpp
	@echo "ğŸ”¨ ç¼–è¯‘HTTP/1.xç¤ºä¾‹..."
	$(CXX) $(CXXFLAGS) $(INCLUDES) -o $@ $< $(LDFLAGS)
	@echo "âœ… HTTP/1.xç¤ºä¾‹ç¼–è¯‘å®Œæˆ"

# ç¼–è¯‘HTTP/2ç¤ºä¾‹  
http2_example: http2_example.cpp
	@echo "ğŸ”¨ ç¼–è¯‘HTTP/2ç¤ºä¾‹..."
	$(CXX) $(CXXFLAGS) $(INCLUDES) -o $@ $< $(LDFLAGS)
	@echo "âœ… HTTP/2ç¤ºä¾‹ç¼–è¯‘å®Œæˆ"

# ç¼–è¯‘ç»¼åˆç¤ºä¾‹
comprehensive_example: comprehensive_example.cpp
	@echo "ğŸ”¨ ç¼–è¯‘ç»¼åˆç¤ºä¾‹..."
	$(CXX) $(CXXFLAGS) $(INCLUDES) -o $@ $< $(LDFLAGS)
	@echo "âœ… ç»¼åˆç¤ºä¾‹ç¼–è¯‘å®Œæˆ"

# è¿è¡Œæ‰€æœ‰ç¤ºä¾‹
run: all
	@echo "\nğŸš€ è¿è¡ŒHTTP/1.xç¤ºä¾‹:"
	@echo "========================"
	./http1_example
	@echo "\nğŸš€ è¿è¡ŒHTTP/2ç¤ºä¾‹:"
	@echo "========================"
	./http2_example  
	@echo "\nğŸš€ è¿è¡Œç»¼åˆç¤ºä¾‹:"
	@echo "========================"
	./comprehensive_example

# è¿è¡Œå•ä¸ªç¤ºä¾‹
run-http1: http1_example
	@echo "ğŸš€ è¿è¡ŒHTTP/1.xç¤ºä¾‹:"
	./http1_example

run-http2: http2_example
	@echo "ğŸš€ è¿è¡ŒHTTP/2ç¤ºä¾‹:"
	./http2_example

run-comprehensive: comprehensive_example
	@echo "ğŸš€ è¿è¡Œç»¼åˆç¤ºä¾‹:"
	./comprehensive_example

# æ¸…ç†
clean:
	@echo "ğŸ§¹ æ¸…ç†ç¼–è¯‘æ–‡ä»¶..."
	rm -f $(TARGETS)
	@echo "âœ… æ¸…ç†å®Œæˆ"

# æ£€æŸ¥ä¾èµ–
check:
	@echo "ğŸ” æ£€æŸ¥ç¼–è¯‘ç¯å¢ƒ..."
	@$(CXX) --version
	@echo "âœ… ç¼–è¯‘å™¨æ£€æŸ¥å®Œæˆ"
	@echo "ğŸ“ æ£€æŸ¥å¤´æ–‡ä»¶..."
	@test -f ../include/http_parse.hpp && echo "âœ… ä¸»å¤´æ–‡ä»¶å­˜åœ¨" || echo "âŒ ä¸»å¤´æ–‡ä»¶ç¼ºå¤±"
	@test -d ../include/http_parse && echo "âœ… å¤´æ–‡ä»¶ç›®å½•å­˜åœ¨" || echo "âŒ å¤´æ–‡ä»¶ç›®å½•ç¼ºå¤±"

# å¸®åŠ©ä¿¡æ¯
help:
	@echo "HTTP Parse Library Examples"
	@echo "=========================="
	@echo ""
	@echo "å¯ç”¨ç›®æ ‡:"
	@echo "  all                 - ç¼–è¯‘æ‰€æœ‰ç¤ºä¾‹"
	@echo "  http1_example       - ç¼–è¯‘HTTP/1.xç¤ºä¾‹"
	@echo "  http2_example       - ç¼–è¯‘HTTP/2ç¤ºä¾‹"
	@echo "  comprehensive_example - ç¼–è¯‘ç»¼åˆç¤ºä¾‹"
	@echo ""
	@echo "è¿è¡Œç›®æ ‡:"
	@echo "  run                 - è¿è¡Œæ‰€æœ‰ç¤ºä¾‹"
	@echo "  run-http1           - è¿è¡ŒHTTP/1.xç¤ºä¾‹"
	@echo "  run-http2           - è¿è¡ŒHTTP/2ç¤ºä¾‹"
	@echo "  run-comprehensive   - è¿è¡Œç»¼åˆç¤ºä¾‹"
	@echo ""
	@echo "å…¶ä»–ç›®æ ‡:"
	@echo "  clean               - æ¸…ç†ç¼–è¯‘æ–‡ä»¶"
	@echo "  check               - æ£€æŸ¥ç¼–è¯‘ç¯å¢ƒ"
	@echo "  help                - æ˜¾ç¤ºæ­¤å¸®åŠ©ä¿¡æ¯"
	@echo ""
	@echo "ç¼–è¯‘è¦æ±‚:"
	@echo "  - C++23å…¼å®¹ç¼–è¯‘å™¨ (GCC 13+, Clang 16+)"
	@echo "  - pthreadæ”¯æŒ"

.PHONY: all run run-http1 run-http2 run-comprehensive clean check help